<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Student Event Form</title>
</head>
<body>
  <h1>Student Participation Form</h1>
  <form id="eventForm">
    <label>School Name: <input type="text" name="schoolName" required></label><br><br>
    <label>Staff 1: <input type="text" name="staff1" required></label><br><br>
    <label>Staff 2: <input type="text" name="staff2" required></label><br><br>

    <div id="students">
      <h3>Student Names (max 25):</h3>
    </div>
    <button type="button" onclick="addStudent()">+ Add Student</button><br><br>

    <h3>Events</h3>
    <label><input type="checkbox" name="event1"> Drawing</label><br>
    <label><input type="checkbox" name="event2"> Singing</label><br>
    <label><input type="checkbox" name="event3"> Dance</label><br>
    <label><input type="checkbox" name="event4"> Skit</label><br>
    <label><input type="checkbox" name="event5"> Quiz</label><br>
    <label><input type="checkbox" name="event6"> Speech</label><br>
    <label><input type="checkbox" name="event7"> Poetry</label><br><br>

    <button type="submit">Submit</button>
  </form>

  <p id="status"></p>

  <script>
    const form = document.getElementById("eventForm");
    const studentsDiv = document.getElementById("students");
    let studentCount = 0;

    function addStudent() {
      if (studentCount >= 25) {
        alert("Maximum 25 students allowed.");
        return;
      }
      const input = document.createElement("input");
      input.type = "text";
      input.name = "student" + studentCount;
      input.placeholder = "Student " + (studentCount + 1);
      input.required = true;
      studentsDiv.appendChild(input);
      studentsDiv.appendChild(document.createElement("br"));
      studentCount++;
    }

    for (let i = 0; i < 5; i++) addStudent(); // Add 5 by default

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const status = document.getElementById("status");
      status.textContent = "Submitting...";

      const formData = new FormData(form);
      const students = [];
      for (let i = 0; i < studentCount; i++) {
        const name = formData.get("student" + i);
        if (name) students.push(name);
      }

      const data = {
        schoolName: formData.get("schoolName"),
        staff1: formData.get("staff1"),
        staff2: formData.get("staff2"),
        students: students,
        event1: formData.get("event1") !== null,
        event2: formData.get("event2") !== null,
        event3: formData.get("event3") !== null,
        event4: formData.get("event4") !== null,
        event5: formData.get("event5") !== null,
        event6: formData.get("event6") !== null,
        event7: formData.get("event7") !== null,
      };

      try {
        const response = await fetch("https://script.google.com/macros/s/AKfycbyu9XG0iAOd0jBZfShaAViVGqrXoWKd0KAgsocEQlDUYmqHdKOLQ9U-x308RCWZhepnJg/exec", {
          method: "POST",
          body: JSON.stringify(data),
          headers: { "Content-Type": "application/json" }
        });

        const result = await response.text();
        if (result.includes("Success")) {
          status.textContent = "Form submitted successfully!";
          form.reset();
        } else {
          status.textContent = "Error submitting form: " + result;
        }
      } catch (err) {
        status.textContent = "Network error: " + err.message;
      }
    });
  </script>
</body>
</html>
