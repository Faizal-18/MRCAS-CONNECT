<!DOCTYPE html>
<html>
<head>
  <title>School Event Registration</title>
</head>
<body>
  <h1>School Event Registration Form</h1>
  <form id="form">
    <label>School Name: <input name="school" required></label><br>
    <label>Staff 1: <input name="staff1" required></label><br>
    <label>Staff 2: <input name="staff2" required></label><br><br>

    <div id="students"></div>
    <button type="submit">Submit</button>
  </form>

  <script>
    const events = ["Dance", "Singing", "Drawing", "Essay", "Quiz", "Drama", "Sports"];
    const studentsDiv = document.getElementById("students");

    for (let i = 1; i <= 25; i++) {
      const div = document.createElement("div");
      div.innerHTML = `<b>Student ${i}:</b> <input type="text" name="student${i}" placeholder="Name">
        ${events.map(event => `<label><input type="checkbox" name="student${i}_${event}"> ${event}</label>`).join(" ")}
        <br>`;
      studentsDiv.appendChild(div);
    }

    document.getElementById("form").addEventListener("submit", async (e) => {
      e.preventDefault();

      const formData = new FormData(e.target);
      const school = formData.get("school");
      const staff1 = formData.get("staff1");
      const staff2 = formData.get("staff2");

      const students = [];
      for (let i = 1; i <= 25; i++) {
        const name = formData.get(`student${i}`);
        if (name && name.trim()) {
          const student = { name, events: {} };
          events.forEach(event => {
            student.events[event] = formData.get(`student${i}_${event}`) ? 1 : 0;
          });
          students.push(student);
        }
      }

      const payload = { school, staff1, staff2, students };

      const response = await fetch("https://script.google.com/macros/s/AKfycbyu9XG0iAOd0jBZfShaAViVGqrXoWKd0KAgsocEQlDUYmqHdKOLQ9U-x308RCWZhepnJg/exec", {
        method: "POST",
        body: JSON.stringify(payload),
        headers: {
          "Content-Type": "application/json"
        }
      });

      const result = await response.text();
      alert(result);
    });
  </script>
</body>
</html>
